<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>{% block title %}Sistema de Puntuación{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/styles.css' %}">
  {% block extra_css %}{% endblock %}
</head>
<body>
  <div class="app">
    {% if request.user.is_authenticated %}
      <aside class="sidebar">
        <div class="brand">
          <div class="logo" aria-hidden="true"></div>
          <div>
            <h1>Sistema de Puntuación</h1>
            <div style="color:var(--text-2); font-size:12px">Reflexo</div>
          </div>
        </div>
        <nav class="nav">
          <a href="/" class="nav-link {% if request.path == '/' %}active{% endif %}">🏠 Dashboard</a>
          {% if request.user.is_admin %}
          <a href="/users/list/" class="nav-link {% if request.path|slice:':7' == '/users/' %}active{% endif %}">👥 Usuarios</a>
          {% endif %}
          <a href="/users/profile/" class="nav-link {% if request.path == '/users/profile/' %}active{% endif %}">🙍‍♂️ Mi perfil</a>
        </nav>
        <p class="hint">Sistema de puntuación quincenal</p>
      </aside>
    {% endif %}

    <section style="display:flex; flex-direction:column; min-width:0">
      {% if request.user.is_authenticated %}
      <header class="header">
        <div class="tabs">
          <span class="tab active">General</span>
        </div>
        <div class="user">
          <span style="color:var(--text-2)">{{ request.user.name }}</span>
          <img class="avatar" src="/media/profile_images/default.jpeg" alt="avatar" />
          <form method="post" action="/logout/">
            {% csrf_token %}
            <button class="logout-btn" type="submit">Cerrar sesión</button>
          </form>
        </div>
      </header>
      {% endif %}

      <main>
        {% if messages %}
        <div class="messages">
          {% for message in messages %}
          <div class="alert alert-{{ message.tags }}">
            {{ message }}
            <button onclick="this.parentElement.style.display='none'">×</button>
          </div>
          {% endfor %}
        </div>
        {% endif %}

        {% block content %}{% endblock %}
      </main>
    </section>
  </div>
  {% block extra_js %}{% endblock %}
</body>
</html>